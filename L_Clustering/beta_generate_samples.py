import tensorflow as tf
import numpy as np

#from beta_functions import create_samples
from beta_functions import create_hex_sample
from beta_functions import plot_clusters

n_features = 2
n_clusters = 3
#n_samples_per_cluster = 500
seed = 700
embiggen_factor = 70

np.random.seed(seed)

#hexdump = "485454502f312e312033303320536565204f746865720d0a4c6f636174696f6e3a20687474703a2f2f31302e302e35302e35322f6c6f676f75742e68746d6c0d0a436f6e74656e742d4c656e6774683a20300d0a0d0a"
#hexdump2 = "504f5354202f6367692f6c616e677561676520485454502f312e310d0a486f73743a2031302e302e35302e35320d0a557365722d4167656e743a204d6f7a696c6c612f352e3020285831313b205562756e74753b204c696e7578207838365f36343b2072"
#hexdump3 = "474554202f6367692f617574683f636d643d6c6f676f757420485454502f312e310d0a486f73743a2031302e302e35302e35320d0a557365722d4167656e743a204d6f7a696c6c612f352e3020285831313b205562756e74753b204c696e7578207838365f36343b2072763a35332e3029204765636b6f2f32303130303130312046697265666f782f35332e300d0a4163636570743a20746578742f68746d6c2c6170706c69636174696f6e2f7868746d6c2b786d6c2c6170706c69636174696f6e2f786d6c3b713d302e392c2a2f2a3b713d302e380d0a4163636570742d4c616e67756167653a20656e2d55532c656e3b713d302e350d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174650d0a526566657265723a20687474703a2f2f31302e302e35302e35322f6874646f63732f6170706c69636174696f6e2e68746d6c0d0a436f6f6b69653a2043303d39636563623464656633636230303430663335666165306264626133333666353b2043313d320d0a417574686f72697a6174696f6e3a2044696765737420757365726e616d653d22454e47494e454552222c207265616c6d3d225061676520616363657373222c206e6f6e63653d226661633438303531343233383462646261393030393133376539636439623863222c207572693d222f6367692f617574683f636d643d6c6f676f7574222c20726573706f6e73653d223664343439653765353430633765663863313634366562386137363062326330222c20716f703d617574682c206e633d30303030303036342c20636e6f6e63653d2261633937633239353037316132313733220d0a436f6e6e656374696f6e3a206b6565702d616c6976650d0a557067726164652d496e7365637572652d52657175657374733a20310d0a0d0a"

#hd=[hexdump,hexdump2,hexdump3]
#hd = [hexdump,hexdump2]

#tcp1 = "9d7201bbc0dd86cd7c050b408010011d724200000101080a09b3ecba01d36315"
#tcp2 = "d9da01bbf6943980f8d2c6f2801805a426ca00000101080afea2262128dda086"
#tcp3 = "aea801bb9e705c73babc37738010032d4c4f00000101080ad4eee54cb050c8aa"
#hd = [tcp1,tcp2,tcp3]

#ip1 = "450000348f8d40004006714d0a1fb8fd34cc4201"
#ip2 = "45000073138d4000400655770a1fb8fd36afd7b5"
#ip3 = "45000034138e4000400655b50a1fb8fd36afd7b5"
#hd = [ip1]

#dnp1 = "6405440a00030004ae7cf2c910828a0005070a64034404007c00caae81c1000039316405440a00030004ae7cc2cb0081760005104c6403440400d800cc6b82f300000133010743e2877d00fff80203c305280000010000000001008102005900818900000000f3810103010003f301203b2803460000010000000000000100010000e80002b9010000000000623d64054447000300046254f4cd008233000701d5017d47ff8702005c4928030004000200010000010003170001f62617810203810003170120032802000100043300c60000000000010000010001000000caf80000ffff6405444c000300046bd8f5ce008233000701f4017d4eff8702005e6d2803000500000081010001000000000221f100010000010003c10001c18120032801b38b00030000c60100000100010000ca00000e2d0002c60100000d00057c4764034404005400cf6282f600000133010752b5877d00ff4302038904280200810000000000a4810103030001fc03a40002a40120032801000300021c0100b700000000010000ca00000001c8011e000095ff0005ff4c6403440400d800d06b82f70000013301075a1a877d00ff9e02030005280000010000000001008102005900818900000000ad810103010003ad0120e62803700000010000000000000100010000e80002b9010000000000623d6405443200030004bde3f8d1008233000701c7017d5dff8702009a37280300050002000100000100030e000158360e8102038100030e00000181450705994c6403440400d800d26b82f900000133010764c8877d00ff760203340528010001000000000200010000890001fe032b00012b8102038100032b0120cb2803110000010000c600000001c7010000c10002e5010000c70000bee564054442000300049addfad3008233000701b5017d6bff87020050ef28030003000000810100010000000002a7d100012000280100030002000100000000f11b010000ca00000001c8010000580005fe4c6403440400d800d46b82fb0000013301076e5e877d00ffc2020305052800000100000000010081020059008189000000000d8101030100030d0120642803f20000010000000000000100010000e80002b9010000000000623d64054438000300040188fcd50082330007016b017d71ff87020055fa28030001000200012000280100030000d898cb0100000100010000ca00000002c70168650000ff0005ff106403440400d600d66a81c30000023401071388fb73"
#hd = [dnp1]


import sys
pkt = sys.argv[1]
img_filename = sys.argv[2]
hd=[pkt]

centroids, samples = create_hex_sample(hd)

model = tf.global_variables_initializer()
with tf.Session() as session:
        sample_values = session.run(samples)
        #print("SAMPLE VALUES")
        #print(sample_values)
        centroid_values = session.run(centroids)
        #print("CENTROID_VALUES")
        #print(centroid_values)


plot_clusters(sample_values, centroid_values, img_filename)
